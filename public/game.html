<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Driven Retro Snake Game</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        #gameContainer {
            text-align: center;
        }
        
        #gameCanvas {
            border: 2px solid #00ff00;
            background: #001100;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        #gameInfo {
            margin-top: 20px;
            font-size: 14px;
        }
        
        #aiExplanation {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 4px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            font-size: 12px;
            display: none;
        }
        
        .retro-button {
            background: #001100;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 8px 16px;
            margin: 5px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
        }
        
        .retro-button:hover {
            background: #00ff00;
            color: #000;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <h1>AI-DRIVEN SNAKE</h1>
        <canvas id="gameCanvas" width="600" height="600"></canvas>
        
        <div id="gameInfo">
            <div>Score: <span id="score">0</span></div>
            <div>Speed: <span id="speed">1.0</span></div>
            <div>AI Status: <span id="aiStatus">Monitoring</span></div>
        </div>
        
        <div id="controls">
            <button class="retro-button" onclick="toggleGame()">Start/Pause</button>
            <button class="retro-button" onclick="resetGame()">Reset</button>
            <button class="retro-button" onclick="toggleAIVisibility()">Toggle AI Info</button>
        </div>
        
        <div id="aiExplanation">
            <strong>AI Decision:</strong> <span id="aiDecision">Initializing...</span>
        </div>
        
        <div style="margin-top: 20px; font-size: 12px;">
            <p>Use WASD or Arrow Keys to control the snake</p>
            <p>The AI adapts difficulty based on your performance</p>
        </div>
    </div>
    
    <script>
        // Simple browser-compatible game implementation
        console.log('Loading AI Snake Game...');
        
        // Game state
        let gameState = {
            snake: [
                { position: { x: 10, y: 10 }, direction: 'RIGHT', age: 0 },
                { position: { x: 9, y: 10 }, direction: 'RIGHT', age: 1 },
                { position: { x: 8, y: 10 }, direction: 'RIGHT', age: 2 }
            ],
            food: { x: 15, y: 10 },
            score: 0,
            gameStatus: 'INIT',
            speed: 1.0,
            gridSize: { width: 20, height: 20 },
            gameTime: 0
        };
        
        let canvas, ctx;
        let cellSize = 30;
        let isRunning = false;
        let gameLoop;
        
        // Initialize game
        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            if (!canvas || !ctx) {
                console.error('Canvas not found or context not available');
                return;
            }
            
            console.log('Canvas initialized:', canvas.width, 'x', canvas.height);
            
            // Set up canvas size
            canvas.width = 600;
            canvas.height = 600;
            cellSize = canvas.width / gameState.gridSize.width;
            
            // Initial render
            renderGame();
            
            // Set up keyboard controls
            document.addEventListener('keydown', handleKeyPress);
            
            console.log('Game initialized successfully');
        }
        
        // Render game
        function renderGame() {
            // Clear canvas
            ctx.fillStyle = '#001100';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = 'rgba(0, 128, 0, 0.1)';
            ctx.lineWidth = 1;
            
            for (let x = 0; x <= gameState.gridSize.width; x++) {
                ctx.beginPath();
                ctx.moveTo(x * cellSize, 0);
                ctx.lineTo(x * cellSize, canvas.height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= gameState.gridSize.height; y++) {
                ctx.beginPath();
                ctx.moveTo(0, y * cellSize);
                ctx.lineTo(canvas.width, y * cellSize);
                ctx.stroke();
            }
            
            // Draw snake
            gameState.snake.forEach((segment, index) => {
                ctx.fillStyle = index === 0 ? '#00C800' : '#00FF00'; // Head is darker
                ctx.fillRect(
                    segment.position.x * cellSize + 2,
                    segment.position.y * cellSize + 2,
                    cellSize - 4,
                    cellSize - 4
                );
            });
            
            // Draw food
            ctx.fillStyle = '#FFFF00';
            ctx.fillRect(
                gameState.food.x * cellSize + 4,
                gameState.food.y * cellSize + 4,
                cellSize - 8,
                cellSize - 8
            );
            
            // Update UI
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('speed').textContent = gameState.speed.toFixed(1);
            document.getElementById('aiStatus').textContent = gameState.gameStatus;
        }
        
        // Handle keyboard input
        function handleKeyPress(event) {
            if (!isRunning) return;
            
            const key = event.key.toLowerCase();
            let newDirection = null;
            
            switch (key) {
                case 'arrowup':
                case 'w':
                    newDirection = 'UP';
                    break;
                case 'arrowdown':
                case 's':
                    newDirection = 'DOWN';
                    break;
                case 'arrowleft':
                case 'a':
                    newDirection = 'LEFT';
                    break;
                case 'arrowright':
                case 'd':
                    newDirection = 'RIGHT';
                    break;
            }
            
            if (newDirection && isValidDirection(newDirection)) {
                gameState.snake[0].direction = newDirection;
            }
        }
        
        function isValidDirection(newDirection) {
            const head = gameState.snake[0];
            const opposites = {
                'UP': 'DOWN',
                'DOWN': 'UP',
                'LEFT': 'RIGHT',
                'RIGHT': 'LEFT'
            };
            return opposites[newDirection] !== head.direction;
        }
        
        // Game loop
        function updateGame() {
            if (!isRunning) return;
            
            // Move snake
            const head = gameState.snake[0];
            const newHead = {
                position: { ...head.position },
                direction: head.direction,
                age: 0
            };
            
            // Update head position
            switch (head.direction) {
                case 'UP': newHead.position.y -= 1; break;
                case 'DOWN': newHead.position.y += 1; break;
                case 'LEFT': newHead.position.x -= 1; break;
                case 'RIGHT': newHead.position.x += 1; break;
            }
            
            // Check collisions
            if (newHead.position.x < 0 || newHead.position.x >= gameState.gridSize.width ||
                newHead.position.y < 0 || newHead.position.y >= gameState.gridSize.height ||
                gameState.snake.some(segment => 
                    segment.position.x === newHead.position.x && 
                    segment.position.y === newHead.position.y)) {
                
                // Game over
                isRunning = false;
                gameState.gameStatus = 'GAME_OVER';
                alert('Game Over! Score: ' + gameState.score);
                return;
            }
            
            gameState.snake.unshift(newHead);
            
            // Check food consumption
            if (newHead.position.x === gameState.food.x && newHead.position.y === gameState.food.y) {
                gameState.score += 10;
                // Generate new food
                do {
                    gameState.food = {
                        x: Math.floor(Math.random() * gameState.gridSize.width),
                        y: Math.floor(Math.random() * gameState.gridSize.height)
                    };
                } while (gameState.snake.some(segment => 
                    segment.position.x === gameState.food.x && 
                    segment.position.y === gameState.food.y));
            } else {
                gameState.snake.pop();
            }
            
            renderGame();
        }
        
        // Global functions for buttons
        function toggleGame() {
            if (gameState.gameStatus === 'INIT' || gameState.gameStatus === 'GAME_OVER') {
                isRunning = true;
                gameState.gameStatus = 'PLAYING';
                gameLoop = setInterval(updateGame, 200);
                console.log('Game started');
            } else if (isRunning) {
                isRunning = false;
                gameState.gameStatus = 'PAUSED';
                clearInterval(gameLoop);
                console.log('Game paused');
            } else {
                isRunning = true;
                gameState.gameStatus = 'PLAYING';
                gameLoop = setInterval(updateGame, 200);
                console.log('Game resumed');
            }
        }
        
        function resetGame() {
            isRunning = false;
            clearInterval(gameLoop);
            
            gameState = {
                snake: [
                    { position: { x: 10, y: 10 }, direction: 'RIGHT', age: 0 },
                    { position: { x: 9, y: 10 }, direction: 'RIGHT', age: 1 },
                    { position: { x: 8, y: 10 }, direction: 'RIGHT', age: 2 }
                ],
                food: { x: 15, y: 10 },
                score: 0,
                gameStatus: 'INIT',
                speed: 1.0,
                gridSize: { width: 20, height: 20 },
                gameTime: 0
            };
            
            renderGame();
            console.log('Game reset');
        }
        
        function toggleAIVisibility() {
            const aiExplanation = document.getElementById('aiExplanation');
            if (aiExplanation) {
                aiExplanation.style.display = aiExplanation.style.display === 'none' ? 'block' : 'none';
                aiExplanation.innerHTML = '<strong>AI Decision:</strong> <span>Simple Snake Game - AI features coming soon!</span>';
            }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>